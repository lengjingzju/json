# LJSON 说明

[English Edition](./README.md)

[LJSON：全能、高性能、真流式的 C 语言 JSON 引擎和数值引擎](./notes/introduction_zh-cn.md)

[yyjson ≠ 万能王者：它只是 LJSON DOM 复用模式的一个特化版本](./notes/cmp_yyjson_zh-cn.md)

[一种有限定义域内快速整除的实现方法](./notes/fastdiv_zh-cn.md)

## 概述

LJSON 是一款面向极致性能设计的双模数据处理引擎，既是符合JSON5标准的全能JSON处理器，也是业界领先的数值字符串双向转换工具库。

* 双重核心能力：
    * JSON全能处理：完整支持JSON5规范，提供DOM/SAX双解析模式，文件流式处理能力
    * 数值转换引擎：独创ldouble算法实现浮点字符串互转，性能碾压传统方案

## 主要特性

### LJSON特性

* 极速JSON处理：远超cJSON，大幅领先RapidJSON，小幅领先yyjson的解析/打印性能
* 先进浮点转换：内置ldouble算法，比标准库快10~70倍，比行业方案快10%~100%
* 完整JSON5支持：十六进制、注释、尾逗号等现代JSON特性（部分特性需要启用json.c中的特定宏）
* 多场景优化：DOM/SAX双模式、内存池、内存复用、文件流处理等高效内存管理
    * LJSON文件流解析时是边读取边解析，打印时是边打印边写入，而不是yyjson读完再解析，打印完再写入的伪流模式
    * 内存复用指：1.原始数据直接作为键和字符串的存储点；2. 多次解析和打印时一直复用同一块内存，库内部都无需进行堆内存分配
    * SAX和文件流配合使用可将内存占用变为常数级，即使1GB的JSON文件也可以仅用KB级的内存转换为格式化的JSON文件
* 多数据类型支持：支持长整型、十六进制数字等扩展类型
* 开发者友好：参考cJSON的接口设计，纯C实现，无第三方库依赖，支持多种编译器和处理器架构

### LDOUBLE算法特性

* 字符串转数值算法比标准库快1~10倍
* 浮点数转字符串LDOUBLE算法为追求性能不完全符合IEEE-754标准，拥有16位精度，且始终输出最短精确表示
    * LDOUBLE算法的耗时仅为sprintf的1.5%-10%（即快10-70倍）
    * LDOUBLE算法除一位小数外一般显著快于grisu2算法，特别是科学计数法表示时，可快100%以上
    * LDOUBLE算法绝大多数情况下快于dragonbox算法 ，特别是科学计数法表示时，可快30%以上

## 编译运行

### 编译方法

* 直接编译

```sh
gcc -o ljson json.c jnum.c json_test.c -O2 -ffunction-sections -fdata-sections -W -Wall
```

* [IMAKE](https://github.com/lengjingzju/cbuild-ng) 编译

```sh
make O=<编译输出目录> && make O=<编译输出目录> DESTDIR=<安装目录>
```

* 交叉编译

```sh
make O=<编译输出目录> CROSS_COMPILE=<交叉编译器前缀> && make O=<编译输出目录> DESTDIR=<安装目录>
```

* 选择浮点数转字符串算法 `gcc -DJSON_DTOA_ALGORITHM=n` 或 `make DTOA=n`， n可能为 0 / 1 / 2 / 3
    * 0: 个人实现的 ldouble 算法
    * 1: C标准库的 sprintf
    * 2: 个人优化的 grisu2 算法
    * 3: 个人优化的 dragonbox 算法
<br>

* Windows MSC
    * 使用 `Visual Studio 2022` 打开 `MSC\ljson\ljson.sln`

### 运行方法

```sh
./ljson <json文件名> <测试序号0-7>
```

### 调试方法

* 设置 json.c 中的变量 `JSON_ERROR_PRINT_ENABLE` 的值为 `1` 后重新编译

### 解析配置

* `#define JSON_PARSE_SKIP_COMMENT         1` : 是否允许类似C语言的单行注释和多行注释(JSON5特性)
* `#define JSON_PARSE_LAST_COMMA           1` : 是否允许JSON_ARRAY或JSON_OBJECT的最后一个元素的末尾有逗号(JSON5特性)
* `#define JSON_PARSE_EMPTY_KEY            0` : 是否允许键为空字符串
* `#define JSON_PARSE_SPECIAL_CHAR         1` : 是否允许字符串中有特殊的字符，例如换行符(JSON5特性)
* `#define JSON_PARSE_SPECIAL_QUOTES       1` : 是否允许字符串值可以使用单引号，键值可以使用单引号或无引号(JSON5特性)
* `#define JSON_PARSE_HEX_NUM              1` : 是否允许十六进制的解析(JSON5特性)
* `#define JSON_PARSE_SPECIAL_NUM          1` : 是否允许特殊的数字，例如前导0，加号，无整数的浮点数等，例如 `+99` `.1234` `10.` `001` 等(JSON5特性)
* `#define JSON_PARSE_SPECIAL_DOUBLE       1` : 是否允许特殊的double值 `NaN` `Infinity` `-Infinity`(JSON5特性)
* `#define JSON_PARSE_SINGLE_VALUE         1` : 是否允许不是JSON_ARRAY或JSON_OBJECT开头的JSON值
* `#define JSON_PARSE_FINISHED_CHAR        0` : 是否解析完成后忽略检查字符串尾部的合法性

注：

* 如果需要100%符合 [nativejson-benchmark](https://github.com/miloyip/nativejson-benchmark)，需要将 `JSON_PARSE_EMPTY_KEY` 置为1，其它值全部置为0。
* `JSON_PARSE_SKIP_COMMENT` 和 `JSON_PARSE_SPECIAL_QUOTES` 置为1时会显著影响解析速度。

## 性能测试

### 测试代码

其它json的测试代码位于benchmark目录，将对应的文件放在对应json工程的根目录即可

```sh
gcc -o cjson cjson_test.c cJSON.c -O2               # cJSON
g++ -o rapidjson rapidjson_test.c -Iinclude -O2     # RapidJSON
gcc -o yyjson yyjson_test.c src/yyjson.c -Isrc -O2  # yyjson
gcc -o strdup strdup_test.c -O2                     # strdup和strlen
```

测试脚本

```sh
#!/bin/bash

src=$1

if [ -z $src ] || [ ! -e $src ]; then
	echo "Usage: $0 <json file>"
	exit 1
fi

run_cmd() {
	printf "%-15s " $1
	eval $@
	sync
	sleep 0.1
}

for i in `seq 1 7`; do
	run_cmd ./ljson $src $i
done

run_cmd ./cjson $src
run_cmd ./rapidjson $src
run_cmd ./yyjson $src
run_cmd ./yyjson $src 1
run_cmd ./strdup $src
```

测试模式

* ljson提供7种测试模式
    * 1: 普通DOM模式，使用malloc申请内存，解析和打印都为字符串
    * 2: 快速DOM模式，申请大内存，然后内存从大内存分配(无法单独释放小内存)，解析和打印都为字符串
    * 3: 重用DOM模式，申请大内存，然后内存从大内存分配(无法单独释放小内存)，且键和字符串值重用原始解析字符串，解析和打印都为字符串
    * 4: 文件DOM模式，无需读完文件再解析或打印完再写入，使用malloc申请内存，边读文件边解析，边打印边写入文件
    * 5: 快速文件DOM模式，无需读完文件再解析或打印完再写入，申请大内存，然后内存从大内存分配(无法单独释放小内存)，边读文件边解析，边打印边写入文件
    * 6: 普通SAX模式，解析和打印都为字符串
    * 7: 文件SAX模式，无需读完文件再解析，边读文件边解析
* yyjson提供两种测试模式：unmutable 和 mutable 模式

### JSON测试结果

注1：主要是测试速度，`O2` 优化等级且默认选项编译，测试文件来自 [nativejson-benchmark](https://github.com/miloyip/nativejson-benchmark) 项目

注2：由于功能增加、逻辑优化等修改，最新版本不一定符合下面测试结果，例如使用了更精确的数字处理，浮点数解析性能会下降(处理canada.json)，优化复用模式(模式3)分支预测，解析性能会上升。

> 测试平台: ARM64开发板 | CPU: ARM CortexA53 | OS: Linux-5.15<br>
> 测试结果: LJSON 比cJSON 解析最快可达 475%，打印最快可达 2836%，LJSON 比 RapidJSON 解析最快可达 131%，打印最快可达 147% (耗时含文件读写时间)

![AARCH64-Linux测试结果](image/test_for_aarch64.png)

> 测试平台: PC | CPU: Intel i7-10700 | OS: Ubuntu 18.04 (VirtualBox)<br>
> 测试结果: LJSON 比cJSON 解析最快可达 560%，打印最快可达 3184%，LJSON 比 RapidJSON 解析最快可达 75%，打印最快可达 133% (耗时含文件读写时间)

![x86_64-Linux测试结果](image/test_for_x86_64.png)

> 测试平台: PC | CPU: Intel i7-1260P | OS: Ubuntu 20.04 (VMWare)<br>
> 测试结果: LJSON 比cJSON 解析最快可达 510%，打印最快可达 2273%，LJSON 比 RapidJSON 解析最快可达 76%，打印最快可达 144% (耗时不含文件读写时间)

### 浮点数转字符串算法测试结果

**测试方法**

```sh
make O=obj
./benchmark/benchmark.sh obj
```
> 测试平台: PC | CPU: Intel i7-1260P | OS: Ubuntu 20.04 (VMWare)<br>
> 测试命令: `./jnum_test <num> 10000000` # 测试千万次
> 测试结果: ldouble比sprintf快一个数量级(某些用例可快40倍)，也比grisu2和dragonbox快一些；ldouble在精度范围内可以保证最短，和printf输出一致

注：三个值分别是输出字符串、千万次运行耗时、对比sprintf的速度提升百分比。

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `0.1` | `0.1` `1307ms` | `0.1` `80ms` `1634%` | `0.1` `73ms` `1790%` | `0.1` `92ms` `1421%` |
| `0.2` | `0.2` `1242ms` | `0.2` `83ms` `1496%` | `0.2` `70ms` `1774%` | `0.2` `88ms` `1411%` |
| `0.3` | `0.3` `1299ms` | `0.3` `86ms` `1510%` | `0.3` `72ms` `1804%` | `0.3` `86ms` `1510%` |
| `0.4` | `0.4` `1251ms` | `0.4` `86ms` `1455%` | `0.4` `76ms` `1646%` | `0.4` `90ms` `1390%` |
| `0.5` | `0.5` `1290ms` | `0.5` `84ms` `1536%` | `0.5` `71ms` `1817%` | `0.5` `80ms` `1612%` |
| `0.6` | `0.6` `1343ms` | `0.6` `83ms` `1618%` | `0.6` `77ms` `1744%` | `0.6` `82ms` `1638%` |
| `0.7` | `0.7` `1321ms` | `0.7` `85ms` `1554%` | `0.7` `77ms` `1716%` | `0.7` `85ms` `1554%` |
| `0.8` | `0.8` `1269ms` | `0.8` `81ms` `1567%` | `0.8` `75ms` `1692%` | `0.8` `82ms` `1548%` |
| `0.9` | `0.9` `1255ms` | `0.9` `82ms` `1530%` | `0.9` `76ms` `1651%` | `0.9` `89ms` `1410%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `0.11` | `0.11` `1350ms` | `0.11` `78ms` `1731%` | `0.11` `100ms` `1350%` | `0.11` `87ms` `1552%` |
| `0.101` | `0.101` `1334ms` | `0.101` `84ms` `1588%` | `0.101` `119ms` `1121%` | `0.101` `94ms` `1419%` |
| `0.1001` | `0.1001` `1403ms` | `0.1001` `86ms` `1631%` | `0.1001` `139ms` `1009%` | `0.1001` `92ms` `1525%` |
| `0.10001` | `0.10001` `1359ms` | `0.10001` `94ms` `1446%` | `0.10001` `129ms` `1053%` | `0.10001` `103ms` `1319%` |
| `0.100001` | `0.100001` `1344ms` | `0.100001` `97ms` `1386%` | `0.100001` `145ms` `927%` | `0.100001` `99ms` `1358%` |
| `0.1000001` | `0.1000001` `1430ms` | `0.1000001` `99ms` `1444%` | `0.1000001` `138ms` `1036%` | `0.1000001` `104ms` `1375%` |
| `0.10000001` | `0.10000001` `1358ms` | `0.10000001` `97ms` `1400%` | `0.10000001` `158ms` `859%` | `0.10000001` `115ms` `1181%` |
| `0.100000001` | `0.100000001` `1372ms` | `0.100000001` `105ms` `1307%` | `0.100000001` `151ms` `909%` | `0.100000001` `107ms` `1282%` |
| `0.1000000001` | `0.1000000001` `1416ms` | `0.1000000001` `110ms` `1287%` | `0.1000000001` `157ms` `902%` | `0.1000000001` `103ms` `1375%` |
| `0.10000000001` | `0.10000000001` `1414ms` | `0.10000000001` `97ms` `1458%` | `0.10000000001` `160ms` `884%` | `0.10000000001` `105ms` `1347%` |
| `0.100000000001` | `0.100000000001` `1417ms` | `0.100000000001` `96ms` `1476%` | `0.100000000001` `169ms` `838%` | `0.100000000001` `106ms` `1337%` |
| `0.1000000000001` | `0.1000000000001` `1400ms` | `0.1000000000001` `93ms` `1505%` | `0.1000000000001` `174ms` `805%` | `0.1000000000001` `102ms` `1373%` |
| `0.10000000000001` | `0.10000000000001` `1399ms` | `0.10000000000001` `97ms` `1442%` | `0.10000000000001` `190ms` `736%` | `0.10000000000001` `102ms` `1372%` |
| `0.100000000000001` | `0.100000000000001` `1357ms` | `0.100000000000001` `91ms` `1491%` | `0.100000000000001` `185ms` `734%` | `0.100000000000001` `104ms` `1305%` |
| `0.1000000000000001` | `0.1000000000000001` `1406ms` | `0.1000000000000001` `92ms` `1528%` | `0.1000000000000001` `200ms` `703%` | `0.1000000000000001` `104ms` `1352%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `1.1` | `1.1` `1105ms` | `1.1` `79ms` `1399%` | `1.1` `94ms` `1176%` | `1.1` `92ms` `1201%` |
| `2.2` | `2.2` `1088ms` | `2.2` `77ms` `1413%` | `2.2` `98ms` `1110%` | `2.2` `95ms` `1145%` |
| `3.3` | `3.3` `1157ms` | `3.3` `77ms` `1503%` | `3.3` `96ms` `1205%` | `3.3` `95ms` `1218%` |
| `4.4` | `4.4` `1107ms` | `4.4` `79ms` `1401%` | `4.4` `96ms` `1153%` | `4.4` `100ms` `1107%` |
| `5.5` | `5.5` `1141ms` | `5.5` `79ms` `1444%` | `5.5` `94ms` `1214%` | `5.5` `93ms` `1227%` |
| `6.6` | `6.6` `1157ms` | `6.6` `80ms` `1446%` | `6.6` `94ms` `1231%` | `6.6` `96ms` `1205%` |
| `7.7` | `7.7` `1094ms` | `7.7` `80ms` `1368%` | `7.7` `92ms` `1189%` | `7.7` `97ms` `1128%` |
| `8.8` | `8.800000000000001` `1340ms` | `8.8` `86ms` `1558%` | `8.8` `96ms` `1396%` | `8.8` `96ms` `1396%` |
| `9.9` | `9.9` `1239ms` | `9.9` `82ms` `1511%` | `9.9` `93ms` `1332%` | `9.9` `93ms` `1332%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `0.1` | `0.1` `1365ms` | `0.1` `85ms` `1606%` | `0.1` `82ms` `1665%` | `0.1` `91ms` `1500%` |
| `0.12` | `0.12` `1473ms` | `0.12` `81ms` `1819%` | `0.12` `99ms` `1488%` | `0.12` `95ms` `1551%` |
| `0.123` | `0.123` `1439ms` | `0.123` `82ms` `1755%` | `0.123` `127ms` `1133%` | `0.123` `99ms` `1454%` |
| `0.1234` | `0.1234` `1427ms` | `0.1234` `86ms` `1659%` | `0.1234` `141ms` `1012%` | `0.1234` `98ms` `1456%` |
| `0.12345` | `0.12345` `1423ms` | `0.12345` `97ms` `1467%` | `0.12345` `131ms` `1086%` | `0.12345` `109ms` `1306%` |
| `0.123456` | `0.123456` `1428ms` | `0.123456` `97ms` `1472%` | `0.123456` `142ms` `1006%` | `0.123456` `108ms` `1322%` |
| `0.1234567` | `0.1234567` `1393ms` | `0.1234567` `104ms` `1339%` | `0.1234567` `153ms` `910%` | `0.1234567` `107ms` `1302%` |
| `0.12345678` | `0.12345678` `1371ms` | `0.12345678` `92ms` `1490%` | `0.12345678` `161ms` `852%` | `0.12345678` `105ms` `1306%` |
| `0.123456789` | `0.123456789` `1454ms` | `0.123456789` `104ms` `1398%` | `0.123456789` `157ms` `926%` | `0.123456789` `121ms` `1202%` |
| `0.12345678901` | `0.12345678901` `1464ms` | `0.12345678901` `111ms` `1319%` | `0.12345678901` `169ms` `866%` | `0.12345678901` `120ms` `1220%` |
| `0.123456789012` | `0.123456789012` `1441ms` | `0.123456789012` `105ms` `1372%` | `0.123456789012` `170ms` `848%` | `0.123456789012` `117ms` `1232%` |
| `0.1234567890123` | `0.1234567890123` `1451ms` | `0.1234567890123` `112ms` `1296%` | `0.1234567890123` `179ms` `811%` | `0.1234567890123` `121ms` `1199%` |
| `0.12345678901234` | `0.12345678901234` `1419ms` | `0.12345678901234` `118ms` `1203%` | `0.12345678901234` `193ms` `735%` | `0.12345678901234` `127ms` `1117%` |
| `0.123456789012345` | `0.123456789012345` `1404ms` | `0.123456789012345` `123ms` `1141%` | `0.123456789012345` `188ms` `747%` | `0.123456789012345` `124ms` `1132%` |
| `0.1234567890123456` | `0.1234567890123456` `1421ms` | `0.1234567890123456` `111ms` `1280%` | `0.1234567890123456` `198ms` `718%` | `0.1234567890123456` `124ms` `1146%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `0.1e100` | `1e+99` `3465ms` | `1e+99` `70ms` `4950%` | `1e+99` `73ms` `4747%` | `1e+99` `80ms` `4331%` |
| `0.12e100` | `1.2e+99` `2759ms` | `1.2e+99` `77ms` `3583%` | `1.2e+99` `92ms` `2999%` | `1.2e+99` `98ms` `2815%` |
| `0.123e100` | `1.23e+99` `3496ms` | `1.23e+99` `81ms` `4316%` | `1.23e+99` `114ms` `3067%` | `1.23e+99` `99ms` `3531%` |
| `0.1234e100` | `1.234e+99` `3507ms` | `1.234e+99` `77ms` `4555%` | `1.234e+99` `135ms` `2598%` | `1.234e+99` `101ms` `3472%` |
| `0.12345e100` | `1.2345e+99` `3526ms` | `1.2345e+99` `85ms` `4148%` | `1.2345e+99` `150ms` `2351%` | `1.2345e+99` `118ms` `2988%` |
| `0.123456e100` | `1.23456e+99` `2944ms` | `1.23456e+99` `83ms` `3547%` | `1.23456e+99` `166ms` `1773%` | `1.23456e+99` `116ms` `2538%` |
| `0.1234567e100` | `1.234567e+99` `3050ms` | `1.234567e+99` `82ms` `3720%` | `1.234567e+99` `196ms` `1556%` | `1.234567e+99` `114ms` `2675%` |
| `0.12345678e100` | `1.2345678e+99` `3530ms` | `1.2345678e+99` `81ms` `4358%` | `1.2345678e+99` `200ms` `1765%` | `1.2345678e+99` `107ms` `3299%` |
| `0.123456789e100` | `1.23456789e+99` `3334ms` | `1.23456789e+99` `96ms` `3473%` | `1.23456789e+99` `191ms` `1746%` | `1.23456789e+99` `122ms` `2733%` |
| `0.12345678901e100` | `1.2345678901e+99` `3534ms` | `1.2345678901e+99` `103ms` `3431%` | `1.2345678901e+99` `222ms` `1592%` | `1.2345678901e+99` `125ms` `2827%` |
| `0.123456789012e100` | `1.23456789012e+99` `3591ms` | `1.23456789012e+99` `105ms` `3420%` | `1.23456789012e+99` `212ms` `1694%` | `1.23456789012e+99` `124ms` `2896%` |
| `0.1234567890123e100` | `1.234567890123e+99` `3628ms` | `1.234567890123e+99` `108ms` `3359%` | `1.234567890123e+99` `219ms` `1657%` | `1.234567890123e+99` `135ms` `2687%` |
| `0.12345678901234e100` | `1.2345678901234e+99` `3670ms` | `1.2345678901234e+99` `104ms` `3529%` | `1.2345678901234e+99` `222ms` `1653%` | `1.2345678901234e+99` `133ms` `2759%` |
| `0.123456789012345e100` | `1.23456789012345e+99` `3687ms` | `1.23456789012345e+99` `107ms` `3446%` | `1.23456789012345e+99` `243ms` `1517%` | `1.23456789012345e+99` `138ms` `2672%` |
| `0.1234567890123456e100` | `1.234567890123456e+99` `3442ms` | `1.234567890123456e+99` `101ms` `3408%` | `1.234567890123456e+99` `242ms` `1422%` | `1.234567890123456e+99` `132ms` `2608%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `0.1e-100` | `1e-101` `1973ms` | `1e-101` `79ms` `2497%` | `1e-101` `83ms` `2377%` | `1e-101` `84ms` `2349%` |
| `0.12e-100` | `1.2e-101` `2067ms` | `1.2e-101` `83ms` `2490%` | `1.2e-101` `98ms` `2109%` | `1.2e-101` `93ms` `2223%` |
| `0.123e-100` | `1.23e-101` `2033ms` | `1.23e-101` `83ms` `2449%` | `1.23e-101` `134ms` `1517%` | `1.23e-101` `102ms` `1993%` |
| `0.1234e-100` | `1.234e-101` `2042ms` | `1.234e-101` `82ms` `2490%` | `1.234e-101` `145ms` `1408%` | `1.234e-101` `106ms` `1926%` |
| `0.12345e-100` | `1.2345e-101` `2021ms` | `1.2345e-101` `86ms` `2350%` | `1.2345e-101` `160ms` `1263%` | `1.2345e-101` `107ms` `1889%` |
| `0.123456e-100` | `1.23456e-101` `2042ms` | `1.23456e-101` `90ms` `2269%` | `1.23456e-101` `190ms` `1075%` | `1.23456e-101` `115ms` `1776%` |
| `0.1234567e-100` | `1.234567e-101` `2090ms` | `1.234567e-101` `91ms` `2297%` | `1.234567e-101` `211ms` `991%` | `1.234567e-101` `115ms` `1817%` |
| `0.12345678e-100` | `1.2345678e-101` `2133ms` | `1.2345678e-101` `89ms` `2397%` | `1.2345678e-101` `226ms` `944%` | `1.2345678e-101` `117ms` `1823%` |
| `0.123456789e-100` | `1.23456789e-101` `2147ms` | `1.23456789e-101` `99ms` `2169%` | `1.23456789e-101` `225ms` `954%` | `1.23456789e-101` `129ms` `1664%` |
| `0.12345678901e-100` | `1.2345678901e-101` `2104ms` | `1.2345678901e-101` `104ms` `2023%` | `1.2345678901e-101` `223ms` `943%` | `1.2345678901e-101` `127ms` `1657%` |
| `0.123456789012e-100` | `1.23456789012e-101` `2100ms` | `1.23456789012e-101` `108ms` `1944%` | `1.23456789012e-101` `241ms` `871%` | `1.23456789012e-101` `119ms` `1765%` |
| `0.1234567890123e-100` | `1.234567890123e-101` `2064ms` | `1.234567890123e-101` `104ms` `1985%` | `1.234567890123e-101` `237ms` `871%` | `1.234567890123e-101` `127ms` `1625%` |
| `0.12345678901234e-100` | `1.2345678901234e-101` `2120ms` | `1.2345678901234e-101` `104ms` `2038%` | `1.2345678901234e-101` `238ms` `891%` | `1.2345678901234e-101` `133ms` `1594%` |
| `0.123456789012345e-100` | `1.23456789012345e-101` `2059ms` | `1.23456789012345e-101` `102ms` `2019%` | `1.23456789012345e-101` `231ms` `891%` | `1.23456789012345e-101` `132ms` `1560%` |
| `0.1234567890123456e-100` | `1.234567890123456e-101` `2042ms` | `1.234567890123456e-101` `107ms` `1908%` | `1.234567890123456e-101` `241ms` `847%` | `1.234567890123456e-101` `135ms` `1513%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `1e1` | `10` `858ms` | `10.0` `31ms` `2768%` | `10.0` `69ms` `1243%` | `10.0` `32ms` `2681%` |
| `1e2` | `100` `999ms` | `100.0` `31ms` `3223%` | `100.0` `71ms` `1407%` | `100.0` `32ms` `3122%` |
| `1e3` | `1000` `1197ms` | `1000.0` `34ms` `3521%` | `1000.0` `72ms` `1662%` | `1000.0` `37ms` `3235%` |
| `1e4` | `10000` `1178ms` | `10000.0` `34ms` `3465%` | `10000.0` `80ms` `1472%` | `10000.0` `34ms` `3465%` |
| `1e5` | `100000` `1326ms` | `100000.0` `34ms` `3900%` | `100000.0` `80ms` `1658%` | `100000.0` `36ms` `3683%` |
| `1e6` | `1000000` `1353ms` | `1000000.0` `38ms` `3561%` | `1000000.0` `75ms` `1804%` | `1000000.0` `39ms` `3469%` |
| `1e7` | `10000000` `1391ms` | `10000000.0` `40ms` `3478%` | `10000000.0` `73ms` `1905%` | `10000000.0` `41ms` `3393%` |
| `1e8` | `100000000` `1426ms` | `100000000.0` `33ms` `4321%` | `100000000.0` `224ms` `637%` | `100000000.0` `38ms` `3753%` |
| `1e9` | `1000000000` `1506ms` | `1000000000.0` `35ms` `4303%` | `1000000000.0` `242ms` `622%` | `1000000000.0` `43ms` `3502%` |
| `1e10` | `10000000000` `1553ms` | `10000000000.0` `40ms` `3882%` | `10000000000.0` `225ms` `690%` | `10000000000.0` `40ms` `3882%` |
| `1e11` | `100000000000` `1668ms` | `100000000000.0` `39ms` `4277%` | `100000000000.0` `227ms` `735%` | `100000000000.0` `42ms` `3971%` |
| `1e12` | `1000000000000` `1738ms` | `1000000000000.0` `35ms` `4966%` | `1000000000000.0` `242ms` `718%` | `1000000000000.0` `40ms` `4345%` |
| `1e13` | `10000000000000` `1766ms` | `10000000000000.0` `41ms` `4307%` | `10000000000000.0` `248ms` `712%` | `10000000000000.0` `43ms` `4107%` |
| `1e14` | `100000000000000` `1859ms` | `100000000000000.0` `44ms` `4225%` | `100000000000000.0` `231ms` `805%` | `100000000000000.0` `43ms` `4323%` |
| `1e15` | `1000000000000000` `1883ms` | `1000000000000000.0` `47ms` `4006%` | `1000000000000000.0` `162ms` `1162%` | `1000000000000000.0` `45ms` `4184%` |
| `1e16` | `1e+16` `1045ms` | `10000000000000000.0` `33ms` `3167%` | `10000000000000000.0` `155ms` `674%` | `10000000000000000.0` `86ms` `1215%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `1e-1` | `0.1` `1386ms` | `0.1` `85ms` `1631%` | `0.1` `79ms` `1754%` | `0.1` `92ms` `1507%` |
| `1e-2` | `0.01` `1391ms` | `0.01` `95ms` `1464%` | `0.01` `83ms` `1676%` | `0.01` `96ms` `1449%` |
| `1e-3` | `0.001` `1514ms` | `0.001` `86ms` `1760%` | `0.001` `90ms` `1682%` | `0.001` `95ms` `1594%` |
| `1e-4` | `0.0001` `1466ms` | `0.0001` `87ms` `1685%` | `0.0001` `94ms` `1560%` | `0.0001` `92ms` `1593%` |
| `1e-5` | `1e-05` `1426ms` | `0.00001` `89ms` `1602%` | `0.00001` `90ms` `1584%` | `0.00001` `93ms` `1533%` |
| `1e-6` | `1e-06` `1612ms` | `0.000001` `82ms` `1966%` | `0.000001` `95ms` `1697%` | `0.000001` `92ms` `1752%` |
| `1e-7` | `1e-07` `1531ms` | `0.0000001` `89ms` `1720%` | `1e-7` `66ms` `2320%` | `0.0000001` `98ms` `1562%` |
| `1e-8` | `1e-08` `1402ms` | `1e-8` `73ms` `1921%` | `1e-8` `69ms` `2032%` | `1e-8` `85ms` `1649%` |
| `1e-9` | `1e-09` `1507ms` | `1e-9` `74ms` `2036%` | `1e-9` `69ms` `2184%` | `1e-9` `82ms` `1838%` |
| `1e-10` | `1e-10` `1484ms` | `1e-10` `77ms` `1927%` | `1e-10` `76ms` `1953%` | `1e-10` `82ms` `1810%` |
| `1e-11` | `9.999999999999999e-12` `1559ms` | `1e-11` `76ms` `2051%` | `1e-11` `90ms` `1732%` | `1e-11` `85ms` `1834%` |
| `1e-12` | `1e-12` `1586ms` | `1e-12` `71ms` `2234%` | `1e-12` `80ms` `1982%` | `1e-12` `80ms` `1982%` |
| `1e-13` | `1e-13` `1600ms` | `1e-13` `75ms` `2133%` | `1e-13` `75ms` `2133%` | `1e-13` `85ms` `1882%` |
| `1e-14` | `1e-14` `1671ms` | `1e-14` `77ms` `2170%` | `1e-14` `74ms` `2258%` | `1e-14` `86ms` `1943%` |
| `1e-15` | `1e-15` `1632ms` | `1e-15` `76ms` `2147%` | `1e-15` `75ms` `2176%` | `1e-15` `87ms` `1876%` |
| `1e-16` | `1e-16` `1552ms` | `1e-16` `78ms` `1990%` | `1e-16` `77ms` `2016%` | `1e-16` `85ms` `1826%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `0.9` | `0.9` `1313ms` | `0.9` `93ms` `1412%` | `0.9` `83ms` `1582%` | `0.9` `93ms` `1412%` |
| `0.99` | `0.99` `1456ms` | `0.99` `85ms` `1713%` | `0.99` `107ms` `1361%` | `0.99` `99ms` `1471%` |
| `0.999` | `0.999` `1397ms` | `0.999` `102ms` `1370%` | `0.999` `125ms` `1118%` | `0.999` `98ms` `1426%` |
| `0.9999` | `0.9999` `1370ms` | `0.9999` `89ms` `1539%` | `0.9999` `142ms` `965%` | `0.9999` `111ms` `1234%` |
| `0.99999` | `0.99999` `1341ms` | `0.99999` `101ms` `1328%` | `0.99999` `134ms` `1001%` | `0.99999` `108ms` `1242%` |
| `0.999999` | `0.999999` `1394ms` | `0.999999` `99ms` `1408%` | `0.999999` `147ms` `948%` | `0.999999` `106ms` `1315%` |
| `0.9999999` | `0.9999999000000001` `1392ms` | `0.9999999` `105ms` `1326%` | `0.9999999` `163ms` `854%` | `0.9999999` `113ms` `1232%` |
| `0.99999999` | `0.9999999899999999` `1420ms` | `0.99999999` `100ms` `1420%` | `0.99999999` `163ms` `871%` | `0.99999999` `124ms` `1145%` |
| `0.999999999` | `0.999999999` `1376ms` | `0.999999999` `109ms` `1262%` | `0.999999999` `155ms` `888%` | `0.999999999` `117ms` `1176%` |
| `0.9999999999` | `0.9999999999` `1412ms` | `0.9999999999` `119ms` `1187%` | `0.9999999999` `167ms` `846%` | `0.9999999999` `115ms` `1228%` |
| `0.99999999999` | `0.99999999999` `1449ms` | `0.99999999999` `110ms` `1317%` | `0.99999999999` `172ms` `842%` | `0.99999999999` `119ms` `1218%` |
| `0.999999999999` | `0.999999999999` `1393ms` | `0.999999999999` `109ms` `1278%` | `0.999999999999` `180ms` `774%` | `0.999999999999` `125ms` `1114%` |
| `0.9999999999999` | `0.9999999999999` `1390ms` | `0.9999999999999` `121ms` `1149%` | `0.9999999999999` `183ms` `760%` | `0.9999999999999` `119ms` `1168%` |
| `0.99999999999999` | `0.99999999999999` `1367ms` | `0.99999999999999` `118ms` `1158%` | `0.99999999999999` `191ms` `716%` | `0.99999999999999` `125ms` `1094%` |
| `0.999999999999999` | `0.999999999999999` `1403ms` | `0.999999999999999` `124ms` `1131%` | `0.999999999999999` `197ms` `712%` | `0.999999999999999` `124ms` `1131%` |
| `0.9999999999999999` | `0.9999999999999999` `1389ms` | `0.9999999999999999` `122ms` `1139%` | `0.9999999999999999` `204ms` `681%` | `0.9999999999999999` `138ms` `1007%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `9.9` | `9.9` `1260ms` | `9.9` `83ms` `1518%` | `9.9` `93ms` `1355%` | `9.9` `97ms` `1299%` |
| `9.99` | `9.99` `1282ms` | `9.99` `86ms` `1491%` | `9.99` `118ms` `1086%` | `9.99` `99ms` `1295%` |
| `9.999` | `9.999000000000001` `1365ms` | `9.999` `84ms` `1625%` | `9.999` `136ms` `1004%` | `9.999` `106ms` `1288%` |
| `9.9999` | `9.9999` `1275ms` | `9.9999` `93ms` `1371%` | `9.9999` `137ms` `931%` | `9.9999` `108ms` `1181%` |
| `9.99999` | `9.99999` `1287ms` | `9.99999` `90ms` `1430%` | `9.99999` `141ms` `913%` | `9.99999` `107ms` `1203%` |
| `9.999999` | `9.999999000000001` `1349ms` | `9.999999` `96ms` `1405%` | `9.999999` `154ms` `876%` | `9.999999` `102ms` `1323%` |
| `9.9999999` | `9.999999900000001` `1355ms` | `9.9999999` `93ms` `1457%` | `9.9999999` `162ms` `836%` | `9.9999999` `117ms` `1158%` |
| `9.99999999` | `9.999999989999999` `1331ms` | `9.99999999` `108ms` `1232%` | `9.99999999` `164ms` `812%` | `9.99999999` `119ms` `1118%` |
| `9.999999999` | `9.999999999` `1388ms` | `9.999999999` `104ms` `1335%` | `9.999999999` `169ms` `821%` | `9.999999999` `130ms` `1068%` |
| `9.9999999999` | `9.9999999999` `1337ms` | `9.9999999999` `101ms` `1324%` | `9.9999999999` `163ms` `820%` | `9.9999999999` `117ms` `1143%` |
| `9.99999999999` | `9.999999999990001` `1332ms` | `9.99999999999` `108ms` `1233%` | `9.999999999990001` `203ms` `656%` | `9.99999999999` `143ms` `931%` |
| `9.999999999999` | `9.999999999999` `1370ms` | `9.999999999999` `110ms` `1245%` | `9.999999999999` `180ms` `761%` | `9.999999999999` `122ms` `1123%` |
| `9.9999999999999` | `9.999999999999901` `1358ms` | `9.9999999999999` `116ms` `1171%` | `9.9999999999999` `185ms` `734%` | `9.9999999999999` `123ms` `1104%` |
| `9.99999999999999` | `9.999999999999989` `1331ms` | `9.99999999999999` `110ms` `1210%` | `9.99999999999999` `194ms` `686%` | `9.99999999999999` `124ms` `1073%` |
| `9.999999999999999` | `9.999999999999998` `1338ms` | `9.999999999999998` `114ms` `1174%` | `9.999999999999999` `200ms` `669%` | `9.999999999999998` `139ms` `963%` |
| `9.9999999999999999` | `10` `869ms` | `10.0` `31ms` `2803%` | `10.0` `69ms` `1259%` | `10.0` `34ms` `2556%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `0.1` | `0.1` `1419ms` | `0.1` `85ms` `1669%` | `0.1` `78ms` `1819%` | `0.1` `99ms` `1433%` |
| `0.11` | `0.11` `1426ms` | `0.11` `89ms` `1602%` | `0.11` `98ms` `1455%` | `0.11` `96ms` `1485%` |
| `0.111` | `0.111` `1439ms` | `0.111` `89ms` `1617%` | `0.111` `129ms` `1116%` | `0.111` `100ms` `1439%` |
| `0.1111` | `0.1111` `1419ms` | `0.1111` `83ms` `1710%` | `0.1111` `142ms` `999%` | `0.1111` `103ms` `1378%` |
| `0.11111` | `0.11111` `1423ms` | `0.11111` `99ms` `1437%` | `0.11111` `136ms` `1046%` | `0.11111` `114ms` `1248%` |
| `0.111111` | `0.111111` `1436ms` | `0.111111` `98ms` `1465%` | `0.111111` `141ms` `1018%` | `0.111111` `106ms` `1355%` |
| `0.1111111` | `0.1111111` `1428ms` | `0.1111111` `97ms` `1472%` | `0.1111111` `152ms` `939%` | `0.1111111` `113ms` `1264%` |
| `0.11111111` | `0.11111111` `1472ms` | `0.11111111` `95ms` `1549%` | `0.11111111` `161ms` `914%` | `0.11111111` `111ms` `1326%` |
| `0.111111111` | `0.111111111` `1464ms` | `0.111111111` `111ms` `1319%` | `0.111111111` `159ms` `921%` | `0.111111111` `120ms` `1220%` |
| `0.1111111111` | `0.1111111111` `1463ms` | `0.1111111111` `106ms` `1380%` | `0.1111111111` `161ms` `909%` | `0.1111111111` `118ms` `1240%` |
| `0.11111111111` | `0.11111111111` `1496ms` | `0.11111111111` `112ms` `1336%` | `0.11111111111` `171ms` `875%` | `0.11111111111` `120ms` `1247%` |
| `0.111111111111` | `0.111111111111` `1469ms` | `0.111111111111` `116ms` `1266%` | `0.111111111111` `168ms` `874%` | `0.111111111111` `116ms` `1266%` |
| `0.1111111111111` | `0.1111111111111` `1442ms` | `0.1111111111111` `127ms` `1135%` | `0.1111111111111` `186ms` `775%` | `0.1111111111111` `127ms` `1135%` |
| `0.11111111111111` | `0.11111111111111` `1468ms` | `0.11111111111111` `117ms` `1255%` | `0.11111111111111` `192ms` `765%` | `0.11111111111111` `129ms` `1138%` |
| `0.111111111111111` | `0.111111111111111` `1458ms` | `0.111111111111111` `112ms` `1302%` | `0.111111111111111` `191ms` `763%` | `0.111111111111111` `125ms` `1166%` |
| `0.1111111111111111` | `0.1111111111111111` `1432ms` | `0.1111111111111111` `117ms` `1224%` | `0.1111111111111111` `204ms` `702%` | `0.1111111111111111` `129ms` `1110%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `1.1` | `1.1` `1170ms` | `1.1` `80ms` `1462%` | `1.1` `94ms` `1245%` | `1.1` `96ms` `1219%` |
| `1.11` | `1.11` `1202ms` | `1.11` `76ms` `1582%` | `1.11` `113ms` `1064%` | `1.11` `98ms` `1227%` |
| `1.111` | `1.111` `1223ms` | `1.111` `81ms` `1510%` | `1.111` `139ms` `880%` | `1.111` `100ms` `1223%` |
| `1.1111` | `1.1111` `1231ms` | `1.1111` `89ms` `1383%` | `1.1111` `154ms` `799%` | `1.1111` `108ms` `1140%` |
| `1.11111` | `1.11111` `1185ms` | `1.11111` `90ms` `1317%` | `1.11111` `149ms` `795%` | `1.11111` `114ms` `1039%` |
| `1.111111` | `1.111111` `1234ms` | `1.111111` `87ms` `1418%` | `1.111111` `155ms` `796%` | `1.111111` `107ms` `1153%` |
| `1.1111111` | `1.1111111` `1207ms` | `1.1111111` `90ms` `1341%` | `1.1111111` `159ms` `759%` | `1.1111111` `110ms` `1097%` |
| `1.11111111` | `1.11111111` `1212ms` | `1.11111111` `105ms` `1154%` | `1.11111111` `172ms` `705%` | `1.11111111` `121ms` `1002%` |
| `1.111111111` | `1.111111111` `1206ms` | `1.111111111` `97ms` `1243%` | `1.111111111` `166ms` `727%` | `1.111111111` `121ms` `997%` |
| `1.1111111111` | `1.1111111111` `1210ms` | `1.1111111111` `104ms` `1163%` | `1.1111111111` `172ms` `703%` | `1.1111111111` `116ms` `1043%` |
| `1.11111111111` | `1.11111111111` `1240ms` | `1.11111111111` `97ms` `1278%` | `1.11111111111` `169ms` `734%` | `1.11111111111` `112ms` `1107%` |
| `1.111111111111` | `1.111111111111` `1204ms` | `1.111111111111` `109ms` `1105%` | `1.111111111111` `181ms` `665%` | `1.111111111111` `134ms` `899%` |
| `1.1111111111111` | `1.1111111111111` `1198ms` | `1.1111111111111` `116ms` `1033%` | `1.1111111111111` `185ms` `648%` | `1.1111111111111` `122ms` `982%` |
| `1.11111111111111` | `1.11111111111111` `1207ms` | `1.11111111111111` `109ms` `1107%` | `1.11111111111111` `194ms` `622%` | `1.11111111111111` `122ms` `989%` |
| `1.111111111111111` | `1.111111111111111` `1218ms` | `1.111111111111111` `117ms` `1041%` | `1.111111111111111` `200ms` `609%` | `1.111111111111111` `128ms` `952%` |
| `1.1111111111111111` | `1.111111111111111` `1185ms` | `1.111111111111111` `116ms` `1022%` | `1.1111111111111112` `212ms` `559%` | `1.1111111111111112` `139ms` `853%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `1e-300` | `1e-300` `2567ms` | `1e-300` `79ms` `3249%` | `1e-300` `91ms` `2821%` | `1e-300` `88ms` `2917%` |
| `1e-301` | `1e-301` `2771ms` | `1e-301` `77ms` `3599%` | `1e-301` `80ms` `3464%` | `1e-301` `86ms` `3222%` |
| `1e-302` | `1e-302` `2907ms` | `1e-302` `80ms` `3634%` | `1e-302` `82ms` `3545%` | `1e-302` `89ms` `3266%` |
| `1e-303` | `9.999999999999999e-304` `2423ms` | `1e-303` `76ms` `3188%` | `1e-303` `78ms` `3106%` | `1e-303` `84ms` `2885%` |
| `1e-304` | `1e-304` `2455ms` | `1e-304` `83ms` `2958%` | `1e-304` `81ms` `3031%` | `1e-304` `89ms` `2758%` |
| `1e-305` | `1e-305` `2631ms` | `1e-305` `80ms` `3289%` | `1e-305` `80ms` `3289%` | `1e-305` `87ms` `3024%` |
| `1e-306` | `1e-306` `2499ms` | `1e-306` `79ms` `3163%` | `1e-306` `82ms` `3048%` | `1e-306` `87ms` `2872%` |
| `1e-307` | `9.999999999999999e-308` `2570ms` | `1e-307` `77ms` `3338%` | `1e-307` `92ms` `2793%` | `1e-307` `87ms` `2954%` |
| `1e-308` | `9.999999999999999e-309` `2682ms` | `1e-308` `69ms` `3887%` | `1e-308` `129ms` `2079%` | `1e-308` `65ms` `4126%` |
| `1e-309` | `1.000000000000002e-309` `2777ms` | `1e-309` `66ms` `4208%` | `1e-309` `98ms` `2834%` | `1e-309` `65ms` `4272%` |
| `1e-310` | `9.999999999999969e-311` `2902ms` | `1e-310` `62ms` `4681%` | `1e-310` `106ms` `2738%` | `1e-310` `56ms` `5182%` |
| `1e-311` | `9.999999999999475e-312` `2600ms` | `1e-311` `64ms` `4062%` | `1e-311` `108ms` `2407%` | `1e-311` `50ms` `5200%` |
| `1e-312` | `9.999999999984653e-313` `2716ms` | `1e-312` `63ms` `4311%` | `1e-312` `102ms` `2663%` | `1e-312` `61ms` `4452%` |
| `1e-313` | `1.000000000013287e-313` `2765ms` | `1e-313` `63ms` `4389%` | `1e-313` `104ms` `2659%` | `1e-313` `54ms` `5120%` |
| `1e-314` | `9.999999999638807e-315` `2838ms` | `1e-314` `61ms` `4652%` | `1e-314` `99ms` `2867%` | `1e-314` `49ms` `5792%` |
| `1e-315` | `9.999999984816838e-316` `2776ms` | `1e-315` `61ms` `4551%` | `1e-315` `137ms` `2026%` | `1e-315` `54ms` `5141%` |
| `1e-316` | `9.999999836597144e-317` `2942ms` | `1e-316` `64ms` `4597%` | `1e-316` `136ms` `2163%` | `1e-316` `51ms` `5769%` |
| `1e-317` | `1.000000230692537e-317` `2989ms` | `1e-317` `51ms` `5861%` | `1e-317` `104ms` `2874%` | `1e-317` `52ms` `5748%` |
| `1e-318` | `9.999987484955998e-319` `3090ms` | `1e-318` `58ms` `5328%` | `1e-318` `111ms` `2784%` | `1e-318` `46ms` `6717%` |
| `1e-319` | `9.99988867182683e-320` `2358ms` | `1e-319` `57ms` `4137%` | `1e-319` `107ms` `2204%` | `1e-319` `48ms` `4912%` |
| `1e-320` | `9.99988867182683e-321` `2434ms` | `1e-320` `53ms` `4592%` | `1e-320` `101ms` `2410%` | `1e-320` `49ms` `4967%` |
| `1e-321` | `9.98012604599318e-322` `2520ms` | `1e-321` `51ms` `4941%` | `1e-321` `97ms` `2598%` | `1e-321` `49ms` `5143%` |
| `1e-322` | `9.881312916824931e-323` `2626ms` | `1e-322` `50ms` `5252%` | `1e-322` `101ms` `2600%` | `1e-322` `43ms` `6107%` |
| `1e-323` | `9.881312916824931e-324` `2529ms` | `1e-323` `47ms` `5381%` | `1e-323` `134ms` `1887%` | `1e-323` `44ms` `5748%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `1e+300` | `1e+300` `3385ms` | `1e+300` `70ms` `4836%` | `1e+300` `83ms` `4078%` | `1e+300` `88ms` `3847%` |
| `1e+301` | `1e+301` `3664ms` | `1e+301` `88ms` `4164%` | `1e+301` `87ms` `4211%` | `1e+301` `87ms` `4211%` |
| `1e+302` | `1e+302` `3707ms` | `1e+302` `79ms` `4692%` | `1e+302` `79ms` `4692%` | `1e+302` `85ms` `4361%` |
| `1e+303` | `1e+303` `3827ms` | `1e+303` `82ms` `4667%` | `1e+303` `82ms` `4667%` | `1e+303` `85ms` `4502%` |
| `1e+304` | `9.999999999999999e+303` `5418ms` | `1e+304` `77ms` `7036%` | `1e+304` `78ms` `6946%` | `1e+304` `86ms` `6300%` |
| `1e+305` | `9.999999999999999e+304` `5343ms` | `1e+305` `75ms` `7124%` | `1e+305` `79ms` `6763%` | `1e+305` `86ms` `6213%` |
| `1e+306` | `1e+306` `3756ms` | `1e+306` `77ms` `4878%` | `1e+306` `76ms` `4942%` | `1e+306` `90ms` `4173%` |
| `1e+307` | `1e+307` `5530ms` | `1e+307` `80ms` `6912%` | `1e+307` `78ms` `7090%` | `1e+307` `84ms` `6583%` |
| `1e+308` | `1e+308` `3623ms` | `1e+308` `81ms` `4473%` | `1e+308` `86ms` `4213%` | `1e+308` `84ms` `4313%` |
| `1e+309` | `inf` `302ms` | `inf` `18ms` `1678%` | `1.797693134862316e+308` `259ms` `117%` | `inf` `18ms` `1678%` |
| `1e+310` | `inf` `305ms` | `inf` `16ms` `1906%` | `1.797693134862316e+308` `250ms` `122%` | `inf` `16ms` `1906%` |

| Input | sprintf | ldouble | grisu2 | dragonbox |
| :---- | :------ | :------ | :----- | :-------- |
| `9.999999999999999` | `9.999999999999998` `1355ms` | `9.999999999999998` `115ms` `1178%` | `9.999999999999999` `214ms` `633%` | `9.999999999999998` `132ms` `1027%` |
| `9.999999999999991` | `9.999999999999991` `1365ms` | `9.999999999999992` `109ms` `1252%` | `9.999999999999992` `211ms` `647%` | `9.999999999999991` `137ms` `996%` |
| `9.999999999999989` | `9.999999999999989` `1347ms` | `9.99999999999999` `103ms` `1308%` | `9.99999999999999` `195ms` `691%` | `9.99999999999999` `125ms` `1078%` |
| `9.999999999999981` | `9.99999999999998` `1352ms` | `9.99999999999998` `115ms` `1176%` | `9.99999999999998` `194ms` `697%` | `9.99999999999998` `127ms` `1065%` |
| `9.999999999999979` | `9.999999999999979` `1350ms` | `9.999999999999978` `118ms` `1144%` | `9.999999999999979` `201ms` `672%` | `9.999999999999979` `137ms` `985%` |
| `9.999999999999971` | `9.999999999999972` `1369ms` | `9.999999999999972` `112ms` `1222%` | `9.999999999999972` `203ms` `674%` | `9.999999999999972` `141ms` `971%` |
| `9.999999999999969` | `9.99999999999997` `1355ms` | `9.99999999999997` `112ms` `1210%` | `9.99999999999997` `194ms` `698%` | `9.99999999999997` `121ms` `1120%` |
| `9.999999999999961` | `9.999999999999961` `1395ms` | `9.999999999999961` `113ms` `1235%` | `9.999999999999961` `204ms` `684%` | `9.999999999999961` `138ms` `1011%` |
| `9.999999999999959` | `9.999999999999959` `1343ms` | `9.99999999999996` `108ms` `1244%` | `9.99999999999996` `200ms` `672%` | `9.99999999999996` `123ms` `1092%` |
| `9.999999999999951` | `9.99999999999995` `1370ms` | `9.99999999999995` `114ms` `1202%` | `9.99999999999995` `191ms` `717%` | `9.99999999999995` `124ms` `1105%` |
| `9.999999999999949` | `9.999999999999948` `1369ms` | `9.999999999999948` `115ms` `1190%` | `9.999999999999949` `198ms` `691%` | `9.999999999999948` `133ms` `1029%` |
| `9.999999999999941` | `9.999999999999941` `1367ms` | `9.999999999999942` `113ms` `1210%` | `9.999999999999942` `211ms` `648%` | `9.999999999999941` `160ms` `854%` |
| `9.999999999999939` | `9.99999999999994` `1345ms` | `9.99999999999994` `105ms` `1281%` | `9.99999999999994` `188ms` `715%` | `9.99999999999994` `120ms` `1121%` |
| `9.999999999999931` | `9.999999999999931` `1340ms` | `9.99999999999993` `117ms` `1145%` | `9.99999999999993` `193ms` `694%` | `9.99999999999993` `126ms` `1063%` |
| `9.999999999999929` | `9.999999999999929` `1350ms` | `9.999999999999929` `116ms` `1164%` | `9.999999999999929` `206ms` `655%` | `9.999999999999929` `135ms` `1000%` |
| `9.999999999999921` | `9.999999999999922` `1317ms` | `9.999999999999922` `113ms` `1165%` | `9.999999999999922` `215ms` `613%` | `9.999999999999922` `149ms` `884%` |
| `9.999999999999919` | `9.999999999999918` `1380ms` | `9.999999999999918` `111ms` `1243%` | `9.999999999999919` `205ms` `673%` | `9.999999999999918` `142ms` `972%` |
| `9.999999999999911` | `9.999999999999911` `1347ms` | `9.999999999999912` `112ms` `1203%` | `9.999999999999912` `206ms` `654%` | `9.999999999999911` `136ms` `990%` |
| `9.999999999999909` | `9.999999999999909` `1339ms` | `9.99999999999991` `107ms` `1251%` | `9.99999999999991` `196ms` `683%` | `9.99999999999991` `129ms` `1038%` |
| `9.999999999999901` | `9.999999999999901` `1360ms` | `9.9999999999999` `117ms` `1162%` | `9.9999999999999` `186ms` `731%` | `9.9999999999999` `121ms` `1124%` |

### 字符串转浮点数算法测试结果

**测试方法**

```sh
make O=obj
./benchmark/benchmark.sh obj atod
```
> 测试平台: PC | CPU: Intel i7-1260P | OS: Ubuntu 20.04 (VMWare)<br>
> 测试命令: `./jnum_test <num> 10000000` # 测试千万次
> 测试结果: ldouble比atod大多数情况下快2~3倍(某些用例可快10倍)

注：三个值分别是输出字符串、千万次运行耗时、对比atod的速度提升百分比。

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `0.1` | ` 0.1 228ms` | `0.1 59ms` `386%` |
| `0.2` | ` 0.2 226ms` | `0.2 57ms` `396%` |
| `0.3` | ` 0.3 229ms` | `0.3 56ms` `409%` |
| `0.4` | ` 0.4 223ms` | `0.4 56ms` `398%` |
| `0.5` | ` 0.5 222ms` | `0.5 57ms` `389%` |
| `0.6` | ` 0.6 223ms` | `0.6 57ms` `391%` |
| `0.7` | ` 0.7 237ms` | `0.7 58ms` `409%` |
| `0.8` | ` 0.8 230ms` | `0.8 56ms` `411%` |
| `0.9` | ` 0.9 236ms` | `0.9 55ms` `429%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `0.11` | ` 0.11 256ms` | `0.11 73ms` `351%` |
| `0.101` | ` 0.101 339ms` | `0.101 77ms` `440%` |
| `0.1001` | ` 0.1001 299ms` | `0.1001 80ms` `374%` |
| `0.10001` | ` 0.10001 354ms` | `0.10001 91ms` `389%` |
| `0.100001` | ` 0.100001 382ms` | `0.100001 83ms` `460%` |
| `0.1000001` | ` 0.1000001 371ms` | `0.1000001 86ms` `431%` |
| `0.10000001` | ` 0.10000001 352ms` | `0.10000001 94ms` `374%` |
| `0.100000001` | ` 0.100000001 421ms` | `0.100000001 98ms` `430%` |
| `0.1000000001` | ` 0.1000000001 419ms` | `0.1000000001 105ms` `399%` |
| `0.10000000001` | ` 0.10000000001 409ms` | `0.10000000001 106ms` `386%` |
| `0.100000000001` | ` 0.100000000001 449ms` | `0.100000000001 114ms` `394%` |
| `0.1000000000001` | ` 0.1000000000001 437ms` | `0.1000000000001 123ms` `355%` |
| `0.10000000000001` | ` 0.10000000000001 457ms` | `0.10000000000001 128ms` `357%` |
| `0.100000000000001` | ` 0.100000000000001 528ms` | `0.100000000000001 139ms` `380%` |
| `0.1000000000000001` | ` 0.1000000000000001 442ms` | `0.1000000000000001 151ms` `293%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `1.1` | ` 1.1 308ms` | `1.1 69ms` `446%` |
| `2.2` | ` 2.2 305ms` | `2.2 62ms` `492%` |
| `3.3` | ` 3.3 312ms` | `3.3 64ms` `488%` |
| `4.4` | ` 4.4 314ms` | `4.4 67ms` `469%` |
| `5.5` | ` 5.5 307ms` | `5.5 68ms` `451%` |
| `6.6` | ` 6.6 315ms` | `6.6 68ms` `463%` |
| `7.7` | ` 7.7 305ms` | `7.7 63ms` `484%` |
| `8.8` | ` 8.8 309ms` | `8.8 64ms` `483%` |
| `9.9` | ` 9.9 309ms` | `9.9 67ms` `461%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `0.1` | ` 0.1 235ms` | `0.1 59ms` `398%` |
| `0.12` | ` 0.12 261ms` | `0.12 74ms` `353%` |
| `0.123` | ` 0.123 362ms` | `0.123 80ms` `452%` |
| `0.1234` | ` 0.1234 315ms` | `0.1234 85ms` `371%` |
| `0.12345` | ` 0.12345 374ms` | `0.12345 89ms` `420%` |
| `0.123456` | ` 0.123456 395ms` | `0.123456 87ms` `454%` |
| `0.1234567` | ` 0.1234567 397ms` | `0.1234567 89ms` `446%` |
| `0.12345678` | ` 0.12345678 359ms` | `0.12345678 100ms` `359%` |
| `0.123456789` | ` 0.123456789 434ms` | `0.123456789 103ms` `421%` |
| `0.12345678901` | ` 0.12345678901 434ms` | `0.12345678901 115ms` `377%` |
| `0.123456789012` | ` 0.123456789012 447ms` | `0.123456789012 119ms` `376%` |
| `0.1234567890123` | ` 0.1234567890123 462ms` | `0.1234567890123 124ms` `373%` |
| `0.12345678901234` | ` 0.12345678901234 475ms` | `0.12345678901234 127ms` `374%` |
| `0.123456789012345` | ` 0.123456789012345 553ms` | `0.123456789012345 152ms` `364%` |
| `0.1234567890123456` | ` 0.1234567890123456 490ms` | `0.1234567890123456 155ms` `316%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `0.1e100` | ` 1e+99 492ms` | `1e+99 131ms` `376%` |
| `0.12e100` | ` 1.2e+99 465ms` | `1.2e+99 125ms` `372%` |
| `0.123e100` | ` 1.23e+99 464ms` | `1.23e+99 128ms` `362%` |
| `0.1234e100` | ` 1.234e+99 454ms` | `1.234e+99 124ms` `366%` |
| `0.12345e100` | ` 1.2345e+99 590ms` | `1.2345e+99 144ms` `410%` |
| `0.123456e100` | ` 1.23456e+99 545ms` | `1.23456e+99 130ms` `419%` |
| `0.1234567e100` | ` 1.234567e+99 562ms` | `1.234567e+99 136ms` `413%` |
| `0.12345678e100` | ` 1.2345678e+99 544ms` | `1.2345678e+99 136ms` `400%` |
| `0.123456789e100` | ` 1.23456789e+99 566ms` | `1.23456789e+99 150ms` `377%` |
| `0.12345678901e100` | ` 1.2345678901e+99 575ms` | `1.2345678901e+99 151ms` `381%` |
| `0.123456789012e100` | ` 1.23456789012e+99 537ms` | `1.23456789012e+99 163ms` `329%` |
| `0.1234567890123e100` | ` 1.234567890123e+99 619ms` | `1.234567890123e+99 165ms` `375%` |
| `0.12345678901234e100` | ` 1.2345678901234e+99 595ms` | `1.2345678901234e+99 175ms` `340%` |
| `0.123456789012345e100` | ` 1.23456789012345e+99 609ms` | `1.23456789012345e+99 177ms` `344%` |
| `0.1234567890123456e100` | ` 1.234567890123456e+99 566ms` | `1.234567890123456e+99 183ms` `309%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `0.1e-100` | ` 1e-101 688ms` | `1e-101 120ms` `573%` |
| `0.12e-100` | ` 1.2e-101 700ms` | `1.2e-101 121ms` `579%` |
| `0.123e-100` | ` 1.23e-101 758ms` | `1.23e-101 124ms` `611%` |
| `0.1234e-100` | ` 1.234e-101 707ms` | `1.234e-101 131ms` `540%` |
| `0.12345e-100` | ` 1.2345e-101 784ms` | `1.2345e-101 133ms` `589%` |
| `0.123456e-100` | ` 1.23456e-101 806ms` | `1.23456e-101 140ms` `576%` |
| `0.1234567e-100` | ` 1.234567e-101 828ms` | `1.234567e-101 135ms` `613%` |
| `0.12345678e-100` | ` 1.2345678e-101 799ms` | `1.2345678e-101 132ms` `605%` |
| `0.123456789e-100` | ` 1.23456789e-101 769ms` | `1.23456789e-101 148ms` `520%` |
| `0.12345678901e-100` | ` 1.2345678901e-101 921ms` | `1.2345678901e-101 148ms` `622%` |
| `0.123456789012e-100` | ` 1.23456789012e-101 769ms` | `1.23456789012e-101 159ms` `484%` |
| `0.1234567890123e-100` | ` 1.234567890123e-101 859ms` | `1.234567890123e-101 165ms` `521%` |
| `0.12345678901234e-100` | ` 1.2345678901234e-101 880ms` | `1.2345678901234e-101 170ms` `518%` |
| `0.123456789012345e-100` | ` 1.23456789012345e-101 869ms` | `1.23456789012345e-101 181ms` `480%` |
| `0.1234567890123456e-100` | ` 1.234567890123456e-101 925ms` | `1.234567890123456e-101 178ms` `520%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `1e1` | ` 10.0 197ms` | `10.0 87ms` `226%` |
| `1e2` | ` 100.0 197ms` | `100.0 86ms` `229%` |
| `1e3` | ` 1000.0 205ms` | `1000.0 85ms` `241%` |
| `1e4` | ` 10000.0 201ms` | `10000.0 83ms` `242%` |
| `1e5` | ` 100000.0 193ms` | `100000.0 80ms` `241%` |
| `1e6` | ` 1000000.0 201ms` | `1000000.0 83ms` `242%` |
| `1e7` | ` 10000000.0 203ms` | `10000000.0 83ms` `245%` |
| `1e8` | ` 100000000.0 201ms` | `100000000.0 81ms` `248%` |
| `1e9` | ` 1000000000.0 207ms` | `1000000000.0 80ms` `259%` |
| `1e10` | ` 10000000000.0 218ms` | `10000000000.0 92ms` `237%` |
| `1e11` | ` 100000000000.0 203ms` | `100000000000.0 89ms` `228%` |
| `1e12` | ` 1000000000000.0 208ms` | `1000000000000.0 91ms` `229%` |
| `1e13` | ` 10000000000000.0 206ms` | `10000000000000.0 98ms` `210%` |
| `1e14` | ` 100000000000000.0 207ms` | `100000000000000.0 93ms` `223%` |
| `1e15` | ` 1000000000000000.0 206ms` | `1000000000000000.0 90ms` `229%` |
| `1e16` | ` 10000000000000000.0 207ms` | `10000000000000000.0 88ms` `235%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `1e-1` | ` 0.1 254ms` | `0.1 94ms` `270%` |
| `1e-2` | ` 0.01 288ms` | `0.01 93ms` `310%` |
| `1e-3` | ` 0.001 341ms` | `0.001 87ms` `392%` |
| `1e-4` | ` 0.0001 289ms` | `0.0001 94ms` `307%` |
| `1e-5` | ` 0.00001 363ms` | `0.00001 93ms` `390%` |
| `1e-6` | ` 0.000001 350ms` | `0.000001 89ms` `393%` |
| `1e-7` | ` 0.0000001 343ms` | `0.0000001 89ms` `385%` |
| `1e-8` | ` 1e-8 304ms` | `1e-8 84ms` `362%` |
| `1e-9` | ` 1e-9 364ms` | `1e-9 91ms` `400%` |
| `1e-10` | ` 1e-10 383ms` | `1e-10 96ms` `399%` |
| `1e-11` | ` 1e-11 353ms` | `1e-11 98ms` `360%` |
| `1e-12` | ` 1e-12 370ms` | `1e-12 95ms` `389%` |
| `1e-13` | ` 1e-13 352ms` | `1e-13 101ms` `349%` |
| `1e-14` | ` 1e-14 357ms` | `1e-14 96ms` `372%` |
| `1e-15` | ` 1e-15 414ms` | `1e-15 96ms` `431%` |
| `1e-16` | ` 1e-16 330ms` | `1e-16 99ms` `333%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `0.9` | ` 0.9 243ms` | `0.9 56ms` `434%` |
| `0.99` | ` 0.99 275ms` | `0.99 81ms` `340%` |
| `0.999` | ` 0.999 378ms` | `0.999 81ms` `467%` |
| `0.9999` | ` 0.9999 346ms` | `0.9999 91ms` `380%` |
| `0.99999` | ` 0.99999 384ms` | `0.99999 97ms` `396%` |
| `0.999999` | ` 0.999999 394ms` | `0.999999 88ms` `448%` |
| `0.9999999` | ` 0.9999999 401ms` | `0.9999999 92ms` `436%` |
| `0.99999999` | ` 0.99999999 375ms` | `0.99999999 105ms` `357%` |
| `0.999999999` | ` 0.999999999 461ms` | `0.999999999 106ms` `435%` |
| `0.9999999999` | ` 0.9999999999 442ms` | `0.9999999999 112ms` `395%` |
| `0.99999999999` | ` 0.99999999999 435ms` | `0.99999999999 120ms` `362%` |
| `0.999999999999` | ` 0.999999999999 470ms` | `0.999999999999 121ms` `388%` |
| `0.9999999999999` | ` 0.9999999999999 467ms` | `0.9999999999999 125ms` `374%` |
| `0.99999999999999` | ` 0.99999999999999 496ms` | `0.99999999999999 133ms` `373%` |
| `0.999999999999999` | ` 0.999999999999999 560ms` | `0.999999999999999 142ms` `394%` |
| `0.9999999999999999` | ` 0.9999999999999999 484ms` | `1.0 153ms` `316%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `9.9` | ` 9.9 331ms` | `9.9 70ms` `473%` |
| `9.99` | ` 9.99 333ms` | `9.99 69ms` `483%` |
| `9.999` | ` 9.999 418ms` | `9.999 75ms` `557%` |
| `9.9999` | ` 9.9999 379ms` | `9.9999 84ms` `451%` |
| `9.99999` | ` 9.99999 456ms` | `9.99999 87ms` `524%` |
| `9.999999` | ` 9.999999 458ms` | `9.999999 95ms` `482%` |
| `9.9999999` | ` 9.9999999 450ms` | `9.9999999 102ms` `441%` |
| `9.99999999` | ` 9.99999999 445ms` | `9.99999999 105ms` `424%` |
| `9.999999999` | ` 9.999999999 524ms` | `9.999999999 106ms` `494%` |
| `9.9999999999` | ` 9.9999999999 517ms` | `9.9999999999 116ms` `446%` |
| `9.99999999999` | ` 9.99999999999 510ms` | `9.99999999999 125ms` `408%` |
| `9.999999999999` | ` 9.999999999999 547ms` | `9.999999999999 130ms` `421%` |
| `9.9999999999999` | ` 9.9999999999999 530ms` | `9.9999999999999 139ms` `381%` |
| `9.99999999999999` | ` 9.99999999999999 533ms` | `9.99999999999999 143ms` `373%` |
| `9.999999999999999` | ` 9.999999999999998 613ms` | `10.0 153ms` `401%` |
| `9.9999999999999999` | ` 10.0 548ms` | `10.0 165ms` `332%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `0.1` | ` 0.1 241ms` | `0.1 59ms` `408%` |
| `0.11` | ` 0.11 289ms` | `0.11 80ms` `361%` |
| `0.111` | ` 0.111 362ms` | `0.111 87ms` `416%` |
| `0.1111` | ` 0.1111 310ms` | `0.1111 87ms` `356%` |
| `0.11111` | ` 0.11111 391ms` | `0.11111 99ms` `395%` |
| `0.111111` | ` 0.111111 412ms` | `0.111111 96ms` `429%` |
| `0.1111111` | ` 0.1111111 414ms` | `0.1111111 95ms` `436%` |
| `0.11111111` | ` 0.11111111 368ms` | `0.11111111 99ms` `372%` |
| `0.111111111` | ` 0.111111111 443ms` | `0.111111111 105ms` `422%` |
| `0.1111111111` | ` 0.1111111111 453ms` | `0.1111111111 115ms` `394%` |
| `0.11111111111` | ` 0.11111111111 444ms` | `0.11111111111 117ms` `379%` |
| `0.111111111111` | ` 0.111111111111 483ms` | `0.111111111111 129ms` `374%` |
| `0.1111111111111` | ` 0.1111111111111 446ms` | `0.1111111111111 125ms` `357%` |
| `0.11111111111111` | ` 0.11111111111111 500ms` | `0.11111111111111 136ms` `368%` |
| `0.111111111111111` | ` 0.111111111111111 562ms` | `0.111111111111111 141ms` `399%` |
| `0.1111111111111111` | ` 0.1111111111111111 466ms` | `0.1111111111111111 156ms` `299%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `1.1` | ` 1.1 322ms` | `1.1 77ms` `418%` |
| `1.11` | ` 1.11 351ms` | `1.11 73ms` `481%` |
| `1.111` | ` 1.111 430ms` | `1.111 78ms` `551%` |
| `1.1111` | ` 1.1111 376ms` | `1.1111 86ms` `437%` |
| `1.11111` | ` 1.11111 468ms` | `1.11111 88ms` `532%` |
| `1.111111` | ` 1.111111 459ms` | `1.111111 92ms` `499%` |
| `1.1111111` | ` 1.1111111 452ms` | `1.1111111 97ms` `466%` |
| `1.11111111` | ` 1.11111111 453ms` | `1.11111111 103ms` `440%` |
| `1.111111111` | ` 1.111111111 524ms` | `1.111111111 106ms` `494%` |
| `1.1111111111` | ` 1.1111111111 527ms` | `1.1111111111 114ms` `462%` |
| `1.11111111111` | ` 1.11111111111 507ms` | `1.11111111111 122ms` `416%` |
| `1.111111111111` | ` 1.111111111111 563ms` | `1.111111111111 126ms` `447%` |
| `1.1111111111111` | ` 1.1111111111111 531ms` | `1.1111111111111 133ms` `399%` |
| `1.11111111111111` | ` 1.11111111111111 517ms` | `1.11111111111111 141ms` `367%` |
| `1.111111111111111` | ` 1.111111111111111 589ms` | `1.111111111111111 160ms` `368%` |
| `1.1111111111111111` | ` 1.111111111111111 548ms` | `1.111111111111111 163ms` `336%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `1e-300` | ` 1e-300 1023ms` | `1e-300 108ms` `947%` |
| `1e-301` | ` 1e-301 1007ms` | `1e-301 108ms` `932%` |
| `1e-302` | ` 1e-302 1002ms` | `1e-302 102ms` `982%` |
| `1e-303` | ` 1e-303 1091ms` | `1e-303 101ms` `1080%` |
| `1e-304` | ` 1e-304 943ms` | `1e-304 104ms` `907%` |
| `1e-305` | ` 1e-305 1021ms` | `1e-305 102ms` `1001%` |
| `1e-306` | ` 1e-306 1007ms` | `1e-306 108ms` `932%` |
| `1e-307` | ` 1e-307 1003ms` | `1e-307 101ms` `993%` |
| `1e-308` | ` 1e-308 971ms` | `1e-308 113ms` `859%` |
| `1e-309` | ` 1e-309 858ms` | `1e-309 105ms` `817%` |
| `1e-310` | ` 1e-310 894ms` | `1e-310 109ms` `820%` |
| `1e-311` | ` 1e-311 946ms` | `1e-311 109ms` `868%` |
| `1e-312` | ` 1e-312 1083ms` | `1e-312 110ms` `985%` |
| `1e-313` | ` 1e-313 1080ms` | `1e-313 109ms` `991%` |
| `1e-314` | ` 1e-314 1147ms` | `1e-314 112ms` `1024%` |
| `1e-315` | ` 1e-315 1231ms` | `1e-315 111ms` `1109%` |
| `1e-316` | ` 1e-316 1160ms` | `1e-316 103ms` `1126%` |
| `1e-317` | ` 1e-317 1252ms` | `1e-317 107ms` `1170%` |
| `1e-318` | ` 1e-318 1241ms` | `1e-318 116ms` `1070%` |
| `1e-319` | ` 1e-319 1217ms` | `1e-319 112ms` `1087%` |
| `1e-320` | ` 1e-320 1020ms` | `1e-320 109ms` `936%` |
| `1e-321` | ` 1e-321 1028ms` | `1e-321 103ms` `998%` |
| `1e-322` | ` 1e-322 1061ms` | `1e-322 111ms` `956%` |
| `1e-323` | ` 1e-323 1118ms` | `1e-323 116ms` `964%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `1e+300` | ` 1e+300 617ms` | `1e+300 113ms` `546%` |
| `1e+301` | ` 1e+301 648ms` | `1e+301 112ms` `579%` |
| `1e+302` | ` 1e+302 637ms` | `1e+302 116ms` `549%` |
| `1e+303` | ` 1e+303 670ms` | `1e+303 105ms` `638%` |
| `1e+304` | ` 1e+304 566ms` | `1e+304 103ms` `550%` |
| `1e+305` | ` 1e+305 610ms` | `1e+305 105ms` `581%` |
| `1e+306` | ` 1e+306 603ms` | `1e+306 103ms` `585%` |
| `1e+307` | ` 1e+307 631ms` | `1e+307 103ms` `613%` |
| `1e+308` | ` 1e+308 620ms` | `1e+308 99ms` `626%` |
| `1e+309` | ` inf 150ms` | `inf 82ms` `183%` |
| `1e+310` | ` inf 125ms` | `inf 92ms` `136%` |

| Input | atod    | ldouble |
| :---- | :------ | :------ |
| `9.999999999999999` | ` 9.999999999999998 619ms` | `10.0 157ms` `394%` |
| `9.999999999999991` | ` 9.999999999999992 601ms` | `9.999999999999992 155ms` `388%` |
| `9.999999999999989` | ` 9.99999999999999 625ms` | `9.999999999999988 152ms` `411%` |
| `9.999999999999981` | ` 9.99999999999998 599ms` | `9.99999999999998 153ms` `392%` |
| `9.999999999999979` | ` 9.999999999999978 630ms` | `9.99999999999998 153ms` `412%` |
| `9.999999999999971` | ` 9.999999999999972 613ms` | `9.999999999999972 165ms` `372%` |
| `9.999999999999969` | ` 9.99999999999997 630ms` | `9.999999999999968 160ms` `394%` |
| `9.999999999999961` | ` 9.999999999999961 594ms` | `9.99999999999996 154ms` `386%` |
| `9.999999999999959` | ` 9.99999999999996 626ms` | `9.99999999999996 159ms` `394%` |
| `9.999999999999951` | ` 9.99999999999995 593ms` | `9.999999999999952 157ms` `378%` |
| `9.999999999999949` | ` 9.999999999999948 619ms` | `9.999999999999948 155ms` `399%` |
| `9.999999999999941` | ` 9.999999999999942 606ms` | `9.99999999999994 161ms` `376%` |
| `9.999999999999939` | ` 9.99999999999994 625ms` | `9.99999999999994 163ms` `383%` |
| `9.999999999999931` | ` 9.99999999999993 619ms` | `9.999999999999932 154ms` `402%` |
| `9.999999999999929` | ` 9.999999999999929 622ms` | `9.999999999999928 165ms` `377%` |
| `9.999999999999921` | ` 9.999999999999922 627ms` | `9.99999999999992 157ms` `399%` |
| `9.999999999999919` | ` 9.999999999999918 610ms` | `9.99999999999992 160ms` `381%` |
| `9.999999999999911` | ` 9.999999999999912 636ms` | `9.999999999999912 161ms` `395%` |
| `9.999999999999909` | ` 9.99999999999991 633ms` | `9.999999999999908 167ms` `379%` |
| `9.999999999999901` | ` 9.9999999999999 630ms` | `9.9999999999999 166ms` `380%` |

## 接口说明

见 `json.h`  `jnum.h` 文件。

## 零堆内存分配模式

对于小JSON文件解析打印时，推荐使用零堆内存分配模式，LJSON库只在第一次处理时分配内存，后续处理LJSON库内部可能不会进行任何堆内存分配。

* 解析存储json对象一直复用内存池mem
* 解析存储字符串值复用原始字符串(即原始字符串会被修改，且使用json过程中不能释放)
* 获取 `JSON_ARRAY` / `JSON_OBJECT` 下的对象可使用 `json_get_items` 加速，可一直复用此对象内存(每个级别都要有单独的 `json_items_t` )
* 打印一直复用 `json_print_ptr_t` 的成员 `p`

```c
size_t len = 0;

// 初始化只做一次(解析)
json_mem_t mem;
pjson_memory_init(&mem);
/* obj_mgr需要设置合适的值以便一个内存块可以存下所有的object, 如果是不复用原始字符串，其它2个mgr也需要设置 */
mem.valid = true;
mem.obj_mgr.mem_size = max_data_size;

// 解析加速复用items
json_items_t items;
memset(&items, 0, sizeof(items));

// 初始化只做一次(打印)
json_print_ptr_t ptr = {PRINT_BUF_LEN, 0};

// 业务循环
while (1) {
    /* ---- 接收消息JSON解析 ---- */
    json_object *json = json_reuse_parse_str(buf, &len, &mem);
        // 获取某JSON_ARRAY下的所有数据
        if (json_get_items(array, &items) < 0)
            return -1;
        for (size_t i = 0; i < items.count; ++i) {
            ids.push_back(json_get_lint_value(items.items[i].json));
        }

    /* ----- 业务处理逻辑 ---- */

    /* ---- 发送消息JSON打印 ----*/
    json_sax_print_hd hd = json_sax_print_unformat_start(100, &ptr); // 开始打印(复用ptr)
    json_sax_print_object(hd, NULL, JSON_SAX_START); // 顶层左花括号
        // 打印某JSON_OBJECT下的数据
        json_sax_print_string(hd, &key, sval);
        // 打印某JSON_ARRAY下的所有数据
        json_sax_print_array(hd, &key, JSON_SAX_START);
        for (const auto &v : ids) {
            json_sax_print_lint(hd, NULL, v);
        }
        json_sax_print_array(hd, NULL, JSON_SAX_FINISH);
    ret |= json_sax_print_object(hd, NULL, JSON_SAX_FINISH); // 顶层右花括号
    json_sax_print_finish(hd, len, &ptr) // 结束打印，生成的字符串位于ptr.p或返回值

    /* ----- JSON内存池处理 ---- */
    // 不再需要json结构，只保留第一个链表节点
    pjson_memory_refresh(&mem);
}

// 销毁资源只做一次(解析)
json_free_items(&items);
pjson_memory_free(&mem);

// 销毁资源只做一次(打印)
json_memory_free(ptr.p);
```

## 参考代码

* 参考了[cJSON](https://github.com/DaveGamble/cJSON)的实现，其中utf16_literal_to_utf8函数完全来自cJSON

## 联系方式

* Phone: +86 18368887550
* wx/qq: 1083936981
* Email: lengjingzju@163.com 3090101217@zju.edu.cn
